function manage_gmail(){return{ready:!0,cleaning:!1,running:!1,bases:[],list_input:[],info_textarea:{total:0,valid_line:0,processed:0},error:null,data:{inputs:{Airtable:{airtable_api_key:null,airtable_base_id:"",airtable_table_name:"gmails"},Textarea:{value:null}},input:"Airtable",loop:50,checkLiveFirst:{active:!1,key:null},login:{active:!0,query:null},changeEmail:{active:!1,query:null,disabled:!1},changePass:{active:!1,query:null,disabled:!1},fixDisable:{active:!1,query:null,disabled:!1}},async show_error(a=null){this.error=a,setTimeout((()=>{this.error=null}),5e3)},async init(){this.list_input=Object.keys(this.data.inputs),this.status();var a=await this.getStorage("manage_gmail_data");a&&(this.data=JSON.parse(a)),this.$watch("data",((a,t)=>chrome.storage.local.set({manage_gmail_data:JSON.stringify(a)}))),this.$watch("data.inputs.Textarea.value",((a,t)=>this.checkTextarea(a))),this.checkTextarea(this.data.inputs.Textarea.value),this.data.inputs.Airtable.airtable_api_key&&""!=this.data.inputs.Airtable.airtable_api_key&&this.getBases()},async setStep(a){"login"==a?this.data.login.active?(this.data.changeEmail.disabled=!1,this.data.changePass.disabled=!1,this.data.fixDisable.disabled=!1):(this.data.changeEmail.active=!1,this.data.changeEmail.disabled=!0,this.data.changePass.active=!1,this.data.changePass.disabled=!0,this.data.fixDisable.active=!1,this.data.fixDisable.disabled=!0):"fixDisable"==a?this.data.fixDisable.active?(this.data.changeEmail.active=!1,this.data.changeEmail.disabled=!0,this.data.changePass.active=!1,this.data.changePass.disabled=!0):(this.data.changeEmail.disabled=!1,this.data.changePass.disabled=!1):"changeEmail"==a?this.data.changeEmail.active?(this.data.fixDisable.active=!1,this.data.fixDisable.disabled=!0):this.data.changePass.active||(this.data.fixDisable.disabled=!1):"changePass"==a&&(this.data.changePass.active?(this.data.fixDisable.active=!1,this.data.fixDisable.disabled=!0):this.data.changeEmail.active||(this.data.fixDisable.disabled=!1))},getStorage:a=>new Promise(((t,i)=>{chrome.storage.local.get([a],(function(i){void 0===i[a]?t(null):t(i[a])}))})),async getBases(){if(""==this.data.inputs.Airtable.airtable_api_key.trim()||!this.data.inputs.Airtable.airtable_api_key)return await this.show_error("Please enter Api key!");this.ready=!1;let a=await fetch("https://api.airtable.com/v0/meta/bases",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.data.inputs.Airtable.airtable_api_key}});if(200==a.status){let t=await a.json();this.bases=t.bases,this.ready=!0}else{let t=await a.json();await this.show_error(t.error.message+": API key airtable wrong!")}},async status(){chrome.runtime.sendMessage({name:"status"},(a=>{this.running=a}))},async clear(){this.cleaning=!0,chrome.runtime.sendMessage({name:"clear"},(a=>{this.cleaning=!1}))},async stop(){chrome.runtime.sendMessage({name:"stop"},(a=>{this.running=a}))},async start(){if(this.data.loop<1)return this.show_error("Min loop =1");if("Airtable"==this.data.input){if(null==this.data.inputs.Airtable.airtable_api_key||""==this.data.inputs.Airtable.airtable_api_key.trim())return this.show_error("Missing API Key from Airtable!");if(null==this.data.inputs.Airtable.airtable_base_id||""==this.data.inputs.Airtable.airtable_base_id.trim())return this.show_error("Missing Base ID!");if(null==this.data.inputs.Airtable.airtable_table_name||""==this.data.inputs.Airtable.airtable_table_name.trim())return this.show_error("Missing Table Name!")}if("Textarea"==this.data.input&&""==this.data.inputs.Textarea.value)return this.show_error("Missing list gmail!");if(this.data.checkLiveFirst.active&&(null==this.data.checkLiveFirst.key||""==this.data.checkLiveFirst.key.trim()))return this.show_error("Missing API key from Ychecker.com!");let a={name:"start",data:JSON.parse(JSON.stringify(this.data))};chrome.runtime.sendMessage(a,(a=>{this.running=!0}))},async checkTextarea(a){if(null==a)return;let t=a.trim().split("\n"),i=0,e=0;for(var s=0;s<t.length;s++){let a=t[s].trim();if(""==a)continue;let l=null,r=!0;a.split(" ").length<2?a.split("|").length<2?a.split("\t").length<2?r=!1:l=a.split("\t"):l=a.split("|"):l=a.split(" "),r?(i++,"invalid"==this.getSubstring(t[s].trim(),"[","]")?(l[0]=l[0].split("]")[1],t[s]=l.map((a=>a.trim())).join("\t")):t[s]=l.map((a=>a.trim())).join("\t"),this.getSubstring(t[s].trim(),"[","]")&&e++):this.getSubstring(t[s].trim(),"[","]")||(t[s]="[invalid]"+t[s].trim())}this.info_textarea={total:t.length,valid_line:i,processed:e},this.data.inputs.Textarea.value=t.join("\n")},getSubstring(a,t,i){const e=a.indexOf(t),s=a.lastIndexOf(i);return-1===e||-1===s?null:a.slice(e+1,s)},wait:a=>new Promise((t=>setTimeout(t,1e3*a)))}}