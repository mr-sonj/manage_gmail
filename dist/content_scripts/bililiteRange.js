!function(){var t="onfocusin"in document.createElement("input")?"focusin":"focus",e=document.createElement("div");e.appendChild(document.createTextNode("x-")),e.appendChild(document.createTextNode("x")),e.normalize();var n=3==e.firstChild.length;function i(){}function o(){}function r(t,e){var n=e.text.replace(/\r/g,"").length;if(t.compareEndPoints("StartToStart",e)<=0)return 0;if(t.compareEndPoints("StartToEnd",e)>=0)return n;for(var i=0;t.compareEndPoints("StartToStart",e)>0;++i,t.moveStart("character",-1));return i}function a(t,e){var n=e.text.replace(/\r/g,"").length;if(t.compareEndPoints("EndToEnd",e)>=0)return n;if(t.compareEndPoints("EndToStart",e)<=0)return 0;for(var i=0;t.compareEndPoints("EndToStart",e)>0;++i,t.moveEnd("character",-1));return i}function s(){}function l(){}function u(t,e){if(t.firstChild)return t.firstChild;if(t.nextSibling)return t.nextSibling;if(t===e)return null;for(;t.parentNode;){if((t=t.parentNode)==e)return null;if(t.nextSibling)return t.nextSibling}return null}function c(t,e,n,i){if(!(e<=0)){var o=t[n?"startContainer":"endContainer"];for(3==o.nodeType&&(e+=t[n?"startOffset":"endOffset"]);o;){if(3==o.nodeType){var r=o.nodeValue.length;if(e<=r){if(t[n?"setStart":"setEnd"](o,e),e==r){for(var a=u(o,i);a&&3==a.nodeType&&0==a.nodeValue.length;a=u(a,i))t[n?"setStartAfter":"setEndAfter"](a);a&&1==a.nodeType&&"BR"==a.nodeName&&t[n?"setStartAfter":"setEndAfter"](a)}return}t[n?"setStartAfter":"setEndAfter"](o),e-=r}o=u(o,i)}}}bililiteRange=function(e,n){var i;if(n)i=new b;else if(window.getSelection&&e.setSelectionRange)try{e.selectionStart,i=new s}catch(c){i=new b}else i=window.getSelection?new l:document.selection?new o:new b;if(i._el=e,i._doc=e.ownerDocument,i._win="defaultView"in i._doc?i._doc.defaultView:i._doc.parentWindow,i._textProp=function(t){return"string"==typeof t.value?"value":void 0!==t.text?"text":void 0!==t.textContent?"textContent":"innerText"}(e),i._bounds=[0,i.length()],!("bililiteRangeMouseDown"in i._doc)){var r={_el:i._doc};i._doc.bililiteRangeMouseDown=!1,bililiteRange.fn.listen.call(r,"mousedown",(function(){i._doc.bililiteRangeMouseDown=!0})),bililiteRange.fn.listen.call(r,"mouseup",(function(){i._doc.bililiteRangeMouseDown=!1}))}if(!("bililiteRangeSelection"in e)){function a(t){t&&9==t.which?i._nativeSelect(i._nativeRange(e.bililiteRangeSelection)):e.bililiteRangeSelection=i._nativeSelection()}a(),"onbeforedeactivate"in e?i.listen("beforedeactivate",a):i.listen("mouseup",a).listen("keyup",a),i.listen(t,(function(){i._doc.bililiteRangeMouseDown||i._nativeSelect(i._nativeRange(e.bililiteRangeSelection))}))}if("oninput"in e)window.FileReader&&!window.MSInputMethodContext||!document.documentMode||i.listen("textinput",(function(){i.dispatch({type:"input",bubbles:!0})}));else{var u=function(){i.dispatch({type:"input",bubbles:!0})};"object"==typeof window.setTimeout&&(i.listen("keyup",u),i.listen("cut",u),i.listen("paste",u),i.listen("drop",u),e.oninput="patched")}return i},i.prototype={length:function(){return this._el[this._textProp].replace(/\r/g,"").length},bounds:function(t){if(bililiteRange.bounds[t])this._bounds=bililiteRange.bounds[t].apply(this);else{if(!t){var e=[Math.max(0,Math.min(this.length(),this._bounds[0])),Math.max(0,Math.min(this.length(),this._bounds[1]))];return e[1]=Math.max(e[0],e[1]),e}this._bounds=t}return this},select:function(){var t=this._el.bililiteRangeSelection=this.bounds();return this._el===this._doc.activeElement&&this._nativeSelect(this._nativeRange(t)),this.dispatch({type:"select",bubbles:!0}),this},text:function(t,e){if(arguments.length){var n=this.bounds();return this._el,this.dispatch({type:"beforeinput",bubbles:!0,data:t,bounds:n}),this._nativeSetText(t,this._nativeRange(n)),"start"==e?this.bounds([n[0],n[0]]):"end"==e?this.bounds([n[0]+t.length,n[0]+t.length]):"all"==e&&this.bounds([n[0],n[0]+t.length]),this.dispatch({type:"input",bubbles:!0,data:t,bounds:n}),this}return this._nativeGetText(this._nativeRange(this.bounds())).replace(/\r/g,"")},insertEOL:function(){return this._nativeEOL(),this._bounds=[this._bounds[0]+1,this._bounds[0]+1],this},sendkeys:function(t){var e=this;function n(t,e){/^{[^}]*}$/.test(e)&&(e=e.slice(1,-1));for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);t.dispatch({type:"keypress",bubbles:!0,keyCode:i,which:i,charCode:i})}t.text(e,"end")}return this.data().sendkeysOriginalText=this.text(),this.data().sendkeysBounds=void 0,t.replace(/{[^}]*}|[^{]+|{/g,(function(t){(bililiteRange.sendkeys[t]||n)(e,t,n)})),this.bounds(this.data().sendkeysBounds),this.dispatch({type:"sendkeys",which:t}),this},top:function(){return this._nativeTop(this._nativeRange(this.bounds()))},scrollIntoView:function(t){var e=this.top();return(this._el.scrollTop>e||this._el.scrollTop+this._el.clientHeight<e)&&(t?t.call(this._el,e):this._el.scrollTop=e),this},wrap:function(t){return this._nativeWrap(t,this._nativeRange(this.bounds())),this},selection:function(t){return arguments.length?this.bounds("selection").text(t,"end").select():this.bounds("selection").text()},clone:function(){return bililiteRange(this._el).bounds(this.bounds())},all:function(t){return arguments.length?(this.dispatch({type:"beforeinput",bubbles:!0,data:t}),this._el[this._textProp]=t,this.dispatch({type:"input",bubbles:!0,data:t}),this):this._el[this._textProp].replace(/\r/g,"")},element:function(){return this._el},dispatch:function(t){t=t||{};var e=document.createEvent?document.createEvent("CustomEvent"):this._doc.createEventObject();for(var n in e.initCustomEvent&&e.initCustomEvent(t.type,!!t.bubbles,!!t.cancelable,t.detail),t)e[n]=t[n];var i=this._el;return setTimeout((function(){try{i.dispatchEvent?i.dispatchEvent(e):i.fireEvent("on"+t.type,document.createEventObject())}catch(r){var n=i["listen"+t.type];if(n)for(var o=0;o<n.length;++o)n[o].call(i,e)}}),0),this},listen:function(t,e){var n=this._el;return n.addEventListener?n.addEventListener(t,e):(n.attachEvent("on"+t,e),(n["listen"+t]=n["listen"+t]||[]).push(e)),this},dontlisten:function(t,e){var n=this._el;if(n.removeEventListener)n.removeEventListener(t,e);else try{n.detachEvent("on"+t,e)}catch(r){var i=n["listen"+t];if(i)for(var o=0;o<i.length;++o)i[o]===e&&(i[o]=function(){})}return this}},bililiteRange.fn=i.prototype,bililiteRange.extend=function(t){for(fn in t)i.prototype[fn]=t[fn]},bililiteRange.bounds={all:function(){return[0,this.length()]},start:function(){return[0,0]},end:function(){return[this.length(),this.length()]},selection:function(){return this._el===this._doc.activeElement?(this.bounds("all"),this._nativeSelection()):this._el.bililiteRangeSelection}},bililiteRange.sendkeys={"{enter}":function(t){t.dispatch({type:"keypress",bubbles:!0,keyCode:"\n",which:"\n",charCode:"\n"}),t.insertEOL()},"{tab}":function(t,e,n){n(t,"\t")},"{newline}":function(t,e,n){n(t,"\n")},"{backspace}":function(t){var e=t.bounds();e[0]==e[1]&&t.bounds([e[0]-1,e[0]]),t.text("","end")},"{del}":function(t){var e=t.bounds();e[0]==e[1]&&t.bounds([e[0],e[0]+1]),t.text("","end")},"{rightarrow}":function(t){var e=t.bounds();e[0]==e[1]&&++e[1],t.bounds([e[1],e[1]])},"{leftarrow}":function(t){var e=t.bounds();e[0]==e[1]&&--e[0],t.bounds([e[0],e[0]])},"{selectall}":function(t){t.bounds("all")},"{selection}":function(t){for(var e=t.data().sendkeysOriginalText,n=0;n<e.length;++n){var i=e.charCodeAt(n);t.dispatch({type:"keypress",bubbles:!0,keyCode:i,which:i,charCode:i})}t.text(e,"end")},"{mark}":function(t){t.data().sendkeysBounds=t.bounds()}},bililiteRange.sendkeys["{Enter}"]=bililiteRange.sendkeys["{enter}"],bililiteRange.sendkeys["{Backspace}"]=bililiteRange.sendkeys["{backspace}"],bililiteRange.sendkeys["{Delete}"]=bililiteRange.sendkeys["{del}"],bililiteRange.sendkeys["{ArrowRight}"]=bililiteRange.sendkeys["{rightarrow}"],bililiteRange.sendkeys["{ArrowLeft}"]=bililiteRange.sendkeys["{leftarrow}"],o.prototype=new i,o.prototype._nativeRange=function(t){var e;return"INPUT"==this._el.tagName?e=this._el.createTextRange():(e=this._doc.body.createTextRange()).moveToElementText(this._el),t&&(t[1]<0&&(t[1]=0),t[0]>this.length()&&(t[0]=this.length()),t[1]<e.text.replace(/\r/g,"").length&&(e.moveEnd("character",-1),e.moveEnd("character",t[1]-e.text.replace(/\r/g,"").length)),t[0]>0&&e.moveStart("character",t[0])),e},o.prototype._nativeSelect=function(t){t.select()},o.prototype._nativeSelection=function(){var t=this._nativeRange(),e=this.length(),n=this._doc.selection.createRange();try{return[r(n,t),a(n,t)]}catch(t){return n.parentElement().sourceIndex<this._el.sourceIndex?[0,0]:[e,e]}},o.prototype._nativeGetText=function(t){return t.text},o.prototype._nativeSetText=function(t,e){e.text=t},o.prototype._nativeEOL=function(){"value"in this._el?this.text("\n"):this._nativeRange(this.bounds()).pasteHTML("\n<br/>")},o.prototype._nativeTop=function(t){var e=this._nativeRange([0,0]);return t.boundingTop-e.boundingTop},o.prototype._nativeWrap=function(t,e){var n=document.createElement("div");n.appendChild(t);var i=n.innerHTML.replace("><",">"+e.htmlText+"<");e.pasteHTML(i)},s.prototype=new i,s.prototype._nativeRange=function(t){return t||[0,this.length()]},s.prototype._nativeSelect=function(t){this._el.setSelectionRange(t[0],t[1])},s.prototype._nativeSelection=function(){return[this._el.selectionStart,this._el.selectionEnd]},s.prototype._nativeGetText=function(t){return this._el.value.substring(t[0],t[1])},s.prototype._nativeSetText=function(t,e){var n=this._el.value;this._el.value=n.substring(0,e[0])+t+n.substring(e[1])},s.prototype._nativeEOL=function(){this.text("\n")},s.prototype._nativeTop=function(t){var e=this._el.cloneNode(!0);e.style.visibility="hidden",e.style.position="absolute",this._el.parentNode.insertBefore(e,this._el),e.style.height="1px",e.value=this._el.value.slice(0,t[0]);var n=e.scrollHeight;return e.value="X",n-=e.scrollHeight,e.parentNode.removeChild(e),n},s.prototype._nativeWrap=function(){throw new Error("Cannot wrap in a text element")},l.prototype=new i,l.prototype._nativeRange=function(t){var e=this._doc.createRange();return e.selectNodeContents(this._el),t&&(c(e,t[0],!0,this._el),e.collapse(!0),c(e,t[1]-t[0],!1,this._el)),e},l.prototype._nativeSelect=function(t){this._win.getSelection().removeAllRanges(),this._win.getSelection().addRange(t)},l.prototype._nativeSelection=function(){var t=this._nativeRange();if(0==this._win.getSelection().rangeCount)return[this.length(),this.length()];var e=this._win.getSelection().getRangeAt(0);return[v(e,t),g(e,t)]},l.prototype._nativeGetText=function(t){return String.prototype.slice.apply(this._el.textContent,this.bounds())},l.prototype._nativeSetText=function(t,e){e.deleteContents(),e.insertNode(this._doc.createTextNode(t)),n&&this._el.normalize()},l.prototype._nativeEOL=function(){var t=this._nativeRange(this.bounds());t.deleteContents();var e=this._doc.createElement("br");e.setAttribute("_moz_dirty",""),t.insertNode(e),t.insertNode(this._doc.createTextNode("\n")),t.collapse(!1)},l.prototype._nativeTop=function(t){if(0==this.length)return 0;if(""==t.toString()){var e=this._doc.createTextNode("X");t.insertNode(e)}var n=this._nativeRange([0,1]),i=t.getBoundingClientRect().top-n.getBoundingClientRect().top;return e&&e.parentNode.removeChild(e),i},l.prototype._nativeWrap=function(t,e){e.surroundContents(t)};var h=0,d=1,p=2,f=3;function v(t,e){return t.compareBoundaryPoints(h,e)<=0?0:t.compareBoundaryPoints(f,e)>=0?e.toString().length:((t=t.cloneRange()).setEnd(e.endContainer,e.endOffset),e.toString().replace(/\r/g,"").length-t.toString().replace(/\r/g,"").length)}function g(t,e){return t.compareBoundaryPoints(p,e)>=0?e.toString().length:t.compareBoundaryPoints(d,e)<=0?0:((t=t.cloneRange()).setStart(e.startContainer,e.startOffset),t.toString().replace(/\r/g,"").length)}function b(){}b.prototype=new i,b.prototype._nativeRange=function(t){return t||[0,this.length()]},b.prototype._nativeSelect=function(t){},b.prototype._nativeSelection=function(){return[0,0]},b.prototype._nativeGetText=function(t){return this._el[this._textProp].substring(t[0],t[1])},b.prototype._nativeSetText=function(t,e){var n=this._el[this._textProp];this._el[this._textProp]=n.substring(0,e[0])+t+n.substring(e[1])},b.prototype._nativeEOL=function(){this.text("\n")},b.prototype._nativeTop=function(){return 0},b.prototype._nativeWrap=function(){throw new Error("Wrapping not implemented")};var _=[];bililiteRange.fn.data=function(){var t=this.element().bililiteRangeData;return null==t&&(t=this.element().bililiteRangeData=_.length,_[t]=new y(this)),_[t]};try{Object.defineProperty({},"foo",{});var y=function(t){Object.defineProperty(this,"values",{value:{}}),Object.defineProperty(this,"sourceRange",{value:t}),Object.defineProperty(this,"toJSON",{value:function(){var t={};for(var e in y.prototype)e in this.values&&(t[e]=this.values[e]);return t}}),Object.defineProperty(this,"all",{get:function(){var t={};for(var e in y.prototype)t[e]=this[e];return t}})};y.prototype={},Object.defineProperty(y.prototype,"values",{value:{}}),Object.defineProperty(y.prototype,"monitored",{value:{}}),bililiteRange.data=function(t,e){e=e||{};var n=Object.getOwnPropertyDescriptor(y.prototype,t)||{};"enumerable"in e&&(n.enumerable=!!e.enumerable),"enumerable"in n||(n.enumerable=!0),"value"in e&&(y.prototype.values[t]=e.value),"monitored"in e&&(y.prototype.monitored[t]=e.monitored),n.configurable=!0,n.get=function(){return t in this.values?this.values[t]:y.prototype.values[t]},n.set=function(e){this.values[t]=e,y.prototype.monitored[t]&&this.sourceRange.dispatch({type:"bililiteRangeData",bubbles:!0,detail:{name:t,value:e}})},Object.defineProperty(y.prototype,t,n)}}catch(t){(y=function(t){this.sourceRange=t}).prototype={},bililiteRange.data=function(t,e){"value"in e&&(y.prototype[t]=e.value)}}}(),Array.prototype.forEach||(Array.prototype.forEach=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=arguments.length>=2?arguments[1]:void 0,o=0;o<n;o++)o in e&&t.call(i,e[o],o,e)});